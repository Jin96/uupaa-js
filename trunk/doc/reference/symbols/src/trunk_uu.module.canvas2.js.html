<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"> <style>
	.KEYW {color: #933;}
	.COMM {color: #bbb; font-style: italic;}
	.NUMB {color: #393;}
	.STRN {color: #393;}
	.REGX {color: #339;}
	.linenumber {border-right: 1px dotted #666; color: #666; font-style: normal;}
	</style></head><body><pre><span class='linenumber'>  1</span> <span class="COMM">/** &lt;b>Canvas Module2&lt;/b>
<span class='linenumber'>  2</span>  *
<span class='linenumber'>  3</span>  * CanvasAPIをラップし、マクロの再生記録とペン座標の履歴機能を持たせたモジュールで、&lt;br />
<span class='linenumber'>  4</span>  * 主にデバッグ用です。
<span class='linenumber'>  5</span>  *
<span class='linenumber'>  6</span>  * @author Takao Obara
<span class='linenumber'>  7</span>  * @license uupaa.js is licensed under the terms and conditions of the MIT licence.
<span class='linenumber'>  8</span>  */</span><span class="WHIT">
<span class='linenumber'>  9</span> </span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="COMM">/* uud = document, */</span><span class="WHIT"> </span><span class="NAME">uuw</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">uu</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">uuw.uu</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 10</span> 
<span class='linenumber'> 11</span> </span><span class="NAME">uu.module.canvas2</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 12</span> 
<span class='linenumber'> 13</span> </span><span class="COMM">/** &lt;b>Canvas 2D Context for Debug&lt;/b>
<span class='linenumber'> 14</span>  *
<span class='linenumber'> 15</span>  * 検証が終わっていないので、このモジュールは使用しないでください
<span class='linenumber'> 16</span>  * @class
<span class='linenumber'> 17</span>  */</span><span class="WHIT">
<span class='linenumber'> 18</span> </span><span class="NAME">uu.module.context2dDebug</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">uu.basicClass</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 19</span> </span><span class="NAME">uu.module.context2dDebug.prototype</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 20</span> 
<span class='linenumber'> 21</span> </span><span class="WHIT">  </span><span class="COMM">/** &lt;b>uu.module.context2dDebug.construct - 初期化&lt;/b>
<span class='linenumber'> 22</span>    * @param context2d context - 2Dコンテキストを指定します。
<span class='linenumber'> 23</span>    */</span><span class="WHIT">
<span class='linenumber'> 24</span> </span><span class="WHIT">  </span><span class="NAME">construct</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">context</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 25</span> </span><span class="WHIT">    </span><span class="NAME">this.ctx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">context</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 26</span> </span><span class="WHIT">    </span><span class="NAME">this.stackSize</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">   </span><span class="COMM">// スタック数</span><span class="WHIT">
<span class='linenumber'> 27</span> </span><span class="WHIT">    </span><span class="NAME">this.zoom</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">   </span><span class="COMM">// ズーム比率</span><span class="WHIT">
<span class='linenumber'> 28</span> </span><span class="WHIT">    </span><span class="NAME">this.offset</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// オフセット</span><span class="WHIT">
<span class='linenumber'> 29</span> </span><span class="WHIT">    </span><span class="NAME">this.rotate</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">      </span><span class="COMM">// 回転</span><span class="WHIT">
<span class='linenumber'> 30</span> </span><span class="WHIT">    </span><span class="NAME">this.clip</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">    </span><span class="COMM">// クリップ</span><span class="WHIT">
<span class='linenumber'> 31</span> </span><span class="WHIT">    </span><span class="COMM">// ---</span><span class="WHIT">
<span class='linenumber'> 32</span> </span><span class="WHIT">    </span><span class="NAME">this.mode</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">/* 0: 通常, 1: rec中, 2: play中 */</span><span class="WHIT">
<span class='linenumber'> 33</span> </span><span class="WHIT">    </span><span class="NAME">this.historyIndex</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 34</span> </span><span class="WHIT">    </span><span class="NAME">this.cmdHistory</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// コマンド履歴</span><span class="WHIT">
<span class='linenumber'> 35</span> </span><span class="WHIT">    </span><span class="NAME">this.penHistory</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// ペン座標履歴</span><span class="WHIT">
<span class='linenumber'> 36</span> </span><span class="WHIT">    </span><span class="NAME">this.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">/* 現在のペン座標(カレントのサブパスの終点) */</span><span class="WHIT">
<span class='linenumber'> 37</span> </span><span class="WHIT">    </span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">/* 現在のペン座標(カレントのサブパスの終点) */</span><span class="WHIT">
<span class='linenumber'> 38</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 39</span> </span><span class="WHIT">  </span><span class="COMM">/** &lt;b>uu.module.context2dDebug.info - コンテキストの情報を取得&lt;/b>
<span class='linenumber'> 40</span>    *
<span class='linenumber'> 41</span>    *  &lt;dl>
<span class='linenumber'> 42</span>    *    &lt;dt>canvas&lt;/dt>&lt;dd>キャンバスオブジェクト&lt;/dd>
<span class='linenumber'> 43</span>    *    &lt;dt>context&lt;/dt>&lt;dd>コンテキスト&lt;/dd>
<span class='linenumber'> 44</span>    *    &lt;dt>w&lt;/dt>&lt;dd>キャンバスの幅&lt;/dd>
<span class='linenumber'> 45</span>    *    &lt;dt>h&lt;/dt>&lt;dd>キャンバスの高さ&lt;/dd>
<span class='linenumber'> 46</span>    *    &lt;dt>mix&lt;/dt>&lt;dd>合成方法&lt;/dd>
<span class='linenumber'> 47</span>    *    &lt;dt>alpha&lt;/dt>&lt;dd>アルファブレンド&lt;/dd>
<span class='linenumber'> 48</span>    *    &lt;dt>pos { x, y }&lt;/dt>&lt;dd>現在のペン座標(カレントパスの終点)&lt;/dd>
<span class='linenumber'> 49</span>    *    &lt;dt>zoom { x, y }&lt;/dt>&lt;dd>拡大倍率&lt;/dd>
<span class='linenumber'> 50</span>    *    &lt;dt>offset { x, y }&lt;/dt>&lt;dd>オフセット&lt;/dd>
<span class='linenumber'> 51</span>    *    &lt;dt>rotate&lt;/dt>&lt;dd>回転度数&lt;/dd>
<span class='linenumber'> 52</span>    *    &lt;dt>clip&lt;/dt>&lt;dd>クリッピング中ならtrue&lt;/dd>
<span class='linenumber'> 53</span>    *    &lt;dt>stackSize&lt;/dt>&lt;dd>スタック数&lt;/dd>
<span class='linenumber'> 54</span>    *    &lt;dt>mode&lt;/dt>&lt;dd>モード&lt;/dd>
<span class='linenumber'> 55</span>    *    &lt;dt>penHistoryLength&lt;/dt>&lt;dd>ペン座標履歴数&lt;/dd>
<span class='linenumber'> 56</span>    *    &lt;dt>cmdHistoryLength&lt;/dt>&lt;dd>コマンド履歴数&lt;/dd>
<span class='linenumber'> 57</span>    *  &lt;/dl>
<span class='linenumber'> 58</span>    *
<span class='linenumber'> 59</span>    * @return hash - hash { canvas, context, w, h, mix, alpha, pos, stackSize } を返します。
<span class='linenumber'> 60</span>    * @see &lt;a href="context.reset()">context.reset()&lt;/a> - コンテキストの初期化
<span class='linenumber'> 61</span>    */</span><span class="WHIT">
<span class='linenumber'> 62</span> </span><span class="WHIT">  </span><span class="NAME">info</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 63</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">canvas</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.ctx.canvas</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">context</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.ctx</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 64</span> </span><span class="WHIT">             </span><span class="NAME">w</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.ctx.canvas.width</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.ctx.canvas.height</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 65</span> </span><span class="WHIT">             </span><span class="NAME">mix</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.ctx.globalCompositeOperation</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">alpha</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.ctx.globalAlpha</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 66</span> </span><span class="WHIT">             </span><span class="NAME">pos</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 67</span> </span><span class="WHIT">             </span><span class="NAME">zoom</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.zoom.x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.zoom.y</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 68</span> </span><span class="WHIT">             </span><span class="NAME">offset</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.offset.x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.offset.y</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 69</span> </span><span class="WHIT">             </span><span class="NAME">rotate</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.rotate</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">clip</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.clip</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 70</span> </span><span class="WHIT">             </span><span class="NAME">stackSize</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.stackSize</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">mode</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.mode</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 71</span> </span><span class="WHIT">             </span><span class="NAME">penHistoryLength</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.penHistory.length</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 72</span> </span><span class="WHIT">             </span><span class="NAME">cmdHistoryLength</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.cmdHistory.length</span><span class="WHIT">
<span class='linenumber'> 73</span> </span><span class="WHIT">           </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 74</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 75</span> 
<span class='linenumber'> 76</span> </span><span class="WHIT">  </span><span class="COMM">/** &lt;b>uu.module.context2dDebug.push - コンテキストの状態をスタックに保存。&lt;/b>
<span class='linenumber'> 77</span>    * @return this - thisを返します。
<span class='linenumber'> 78</span>    */</span><span class="WHIT">
<span class='linenumber'> 79</span> </span><span class="WHIT">  </span><span class="NAME">push</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 80</span> </span><span class="WHIT">    </span><span class="NAME">this.ctx.save</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 81</span> </span><span class="WHIT">    </span><span class="PUNC">++</span><span class="NAME">this.stackSize</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 82</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 83</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 84</span> </span><span class="WHIT">  </span><span class="COMM">/** &lt;b>uu.module.context2dDebug.pop - コンテキストの状態をスタックから復元。&lt;/b>
<span class='linenumber'> 85</span>    * @return this - thisを返します。
<span class='linenumber'> 86</span>    */</span><span class="WHIT">
<span class='linenumber'> 87</span> </span><span class="WHIT">  </span><span class="NAME">pop</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 88</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.stackSize</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 89</span> </span><span class="WHIT">      </span><span class="PUNC">--</span><span class="NAME">this.stackSize</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 90</span> </span><span class="WHIT">      </span><span class="NAME">this.ctx.restore</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 91</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 92</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 93</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 94</span> </span><span class="WHIT">  </span><span class="COMM">/** &lt;b>uu.module.context2dDebug.reset - コンテキストの初期化&lt;/b>
<span class='linenumber'> 95</span>    * @return this - thisを返します。
<span class='linenumber'> 96</span>    */</span><span class="WHIT">
<span class='linenumber'> 97</span> </span><span class="WHIT">  </span><span class="NAME">reset</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 98</span> </span><span class="WHIT">    </span><span class="NAME">this.ctx.strokeStyle</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"black"</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 99</span> </span><span class="WHIT">    </span><span class="NAME">this.ctx.fillStyle</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"black"</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>100</span> </span><span class="WHIT">    </span><span class="NAME">this.ctx.lineWidth</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>101</span> </span><span class="WHIT">    </span><span class="NAME">this.ctx.lineCap</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"butt"</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>102</span> </span><span class="WHIT">    </span><span class="NAME">this.ctx.lineJoin</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"miter"</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>103</span> </span><span class="WHIT">    </span><span class="NAME">this.ctx.miterLimit</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">10</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>104</span> </span><span class="WHIT">    </span><span class="NAME">this.ctx.shadowBlur</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>105</span> </span><span class="WHIT">    </span><span class="NAME">this.ctx.shadowColor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"black"</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>106</span> </span><span class="WHIT">    </span><span class="NAME">this.ctx.globalAlpha</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1.0</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>107</span> </span><span class="WHIT">    </span><span class="NAME">this.ctx.globalComposite</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"source-over"</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>108</span> </span><span class="WHIT">    </span><span class="COMM">// ---</span><span class="WHIT">
<span class='linenumber'>109</span> </span><span class="WHIT">    </span><span class="NAME">this.stackSize</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>110</span> </span><span class="WHIT">    </span><span class="NAME">this.zoom</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>111</span> </span><span class="WHIT">    </span><span class="NAME">this.offset</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// オフセット</span><span class="WHIT">
<span class='linenumber'>112</span> </span><span class="WHIT">    </span><span class="NAME">this.rotate</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// 回転</span><span class="WHIT">
<span class='linenumber'>113</span> </span><span class="WHIT">    </span><span class="NAME">this.clip</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">    </span><span class="COMM">// クリップ... クリッピング情報をリセットすべきか?</span><span class="WHIT">
<span class='linenumber'>114</span> </span><span class="WHIT">    </span><span class="NAME">this.ctx.beginPath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>115</span> </span><span class="WHIT">    </span><span class="NAME">this.ctx.rect</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.ctx.canvas.width</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.ctx.canvas.height</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>116</span> </span><span class="WHIT">    </span><span class="NAME">this.ctx.clip</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>117</span> </span><span class="WHIT">    </span><span class="NAME">this.mode</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>118</span> </span><span class="WHIT">    </span><span class="NAME">this.historyIndex</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>119</span> </span><span class="WHIT">    </span><span class="NAME">this.cmdHistory</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// コマンド履歴</span><span class="WHIT">
<span class='linenumber'>120</span> </span><span class="WHIT">    </span><span class="NAME">this.penHistory</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// 座標履歴</span><span class="WHIT">
<span class='linenumber'>121</span> </span><span class="WHIT">    </span><span class="NAME">this.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>122</span> </span><span class="WHIT">    </span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>123</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>124</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>125</span> </span><span class="WHIT">  </span><span class="COMM">/** &lt;b>uu.module.context2dDebug.toDataURL - data: URIの生成&lt;/b>
<span class='linenumber'>126</span>    *  &lt;dl>
<span class='linenumber'>127</span>    *    &lt;dt>image/png&lt;/dt>&lt;dd>png画像, Firefox2+,Safari3+,Opera9+で使用可能&lt;/dd>
<span class='linenumber'>128</span>    *    &lt;dt>image/jpeg&lt;/dt>&lt;dd>jpg画像, Firefox2+,Safari3+で使用可能&lt;/dd>
<span class='linenumber'>129</span>    *  &lt;/dl>
<span class='linenumber'>130</span>    * @param string type - 画像フォーマットを文字列で指定します。デフォルトは "image/png" です。
<span class='linenumber'>131</span>    * @return string - data: URIを返します。返された文字列はimg要素のsrcに指定可能です。
<span class='linenumber'>132</span>    */</span><span class="WHIT">
<span class='linenumber'>133</span> </span><span class="WHIT">  </span><span class="NAME">toDataURL</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">type</span><span class="WHIT"> </span><span class="COMM">/* = "image/png" */</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>134</span> </span><span class="WHIT">    </span><span class="NAME">this.ctx.canvas.toDataURL</span><span class="PUNC">(</span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="STRN">"image/png"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>135</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>136</span> </span><span class="WHIT">  </span><span class="COMM">/** &lt;b>uu.module.context2dDebug.begin - 座標を記録&lt;/b> */</span><span class="WHIT">
<span class='linenumber'>137</span> </span><span class="WHIT">  </span><span class="NAME">_posRec</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>138</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.mode</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>139</span> </span><span class="WHIT">      </span><span class="NAME">this.penHistory</span><span class="PUNC">[</span><span class="NAME">this.historyIndex</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">push</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>140</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>141</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>142</span> </span><span class="WHIT">  </span><span class="NAME">_cmdRec</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">cmd</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">params__</span><span class="WHIT"> </span><span class="COMM">/* ... */</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>143</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.mode</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>144</span> </span><span class="WHIT">      </span><span class="NAME">this.cmdHistory</span><span class="PUNC">[</span><span class="NAME">this.historyIndex</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">push</span><span class="PUNC">(</span><span class="NAME">uu.toArray</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>145</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>146</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>147</span> </span><span class="WHIT">  </span><span class="COMM">/** &lt;b>uu.module.context2dDebug.begin - コマンドの記録&lt;/b>
<span class='linenumber'>148</span>    *
<span class='linenumber'>149</span>    * コマンドの記録を開始します。
<span class='linenumber'>150</span>    *
<span class='linenumber'>151</span>    * @see &lt;a href="#stop">uu.module.context2dDebug.stop()&lt;/a> - コマンドの記録停止
<span class='linenumber'>152</span>    * @see &lt;a href="#play">uu.module.context2dDebug.play()&lt;/a> - コマンドの再生
<span class='linenumber'>153</span>    */</span><span class="WHIT">
<span class='linenumber'>154</span> </span><span class="WHIT">  </span><span class="NAME">record</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>155</span> </span><span class="WHIT">    </span><span class="NAME">this.mode</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>156</span> </span><span class="WHIT">    </span><span class="NAME">this.penHistory</span><span class="PUNC">[</span><span class="NAME">this.historyIndex</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>157</span> </span><span class="WHIT">    </span><span class="NAME">this.cmdHistory</span><span class="PUNC">[</span><span class="NAME">this.historyIndex</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>158</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>159</span> </span><span class="WHIT">  </span><span class="COMM">/** &lt;b>uu.module.context2dDebug.begin - コマンドの再生&lt;/b>
<span class='linenumber'>160</span>    *
<span class='linenumber'>161</span>    * @param function fn - 1step毎にコールバックする関数を指定します。デフォルトはundefinedです。
<span class='linenumber'>162</span>    * @see &lt;a href="#recode">uu.module.context2dDebug.recode()&lt;/a> - コマンドの記録
<span class='linenumber'>163</span>    */</span><span class="WHIT">
<span class='linenumber'>164</span> </span><span class="WHIT">  </span><span class="NAME">play</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">fn</span><span class="WHIT"> </span><span class="COMM">/* = undefined */</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>165</span> </span><span class="WHIT">    </span><span class="NAME">fn</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">fn</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">uu.mute</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>166</span> </span><span class="WHIT">    </span><span class="NAME">this.mode</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>167</span> </span><span class="WHIT">    </span><span class="COMM">// [ cmd, param1, param2, paramx... ]</span><span class="WHIT">
<span class='linenumber'>168</span> </span><span class="WHIT">    </span><span class="NAME">this.cmdHistory</span><span class="PUNC">[</span><span class="NAME">this.historyIndex</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>169</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">cmd</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">v</span><span class="PUNC">[</span><span class="NAME">this.memid</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">param</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">v.slice</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>170</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">cmd</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>171</span> </span><span class="WHIT">        </span><span class="NAME">this.cmd.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">param</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>172</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>173</span> </span><span class="WHIT">      </span><span class="NAME">fn</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>174</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>175</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>176</span> </span><span class="WHIT">  </span><span class="COMM">/** &lt;b>uu.module.context2dDebug.stop - コマンドの記録を停止&lt;/b>
<span class='linenumber'>177</span>    *
<span class='linenumber'>178</span>    * コマンドの記録を停止します。
<span class='linenumber'>179</span>    *
<span class='linenumber'>180</span>    * @see &lt;a href="#recode">uu.module.context2dDebug.recode()&lt;/a> - コマンドの記録
<span class='linenumber'>181</span>    * @see &lt;a href="#play">uu.module.context2dDebug.play()&lt;/a> - コマンドの再生
<span class='linenumber'>182</span>    */</span><span class="WHIT">
<span class='linenumber'>183</span> </span><span class="WHIT">  </span><span class="NAME">stop</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>184</span> </span><span class="WHIT">    </span><span class="NAME">this.mode</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>185</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>186</span> </span><span class="WHIT">  </span><span class="NAME">ctx</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>187</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.ctx</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>188</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>189</span> </span><span class="WHIT">  </span><span class="COMM">/** &lt;b>uu.module.context2dDebug.begin - 合成方法を指定&lt;/b>
<span class='linenumber'>190</span>    *
<span class='linenumber'>191</span>    *  &lt;dl>
<span class='linenumber'>192</span>    *    &lt;dt>source-atop&lt;/dt>&lt;dd>&lt;/dd>
<span class='linenumber'>193</span>    *    &lt;dt>source-in&lt;/dt>&lt;dd>&lt;/dd>
<span class='linenumber'>194</span>    *    &lt;dt>source-out&lt;/dt>&lt;dd>&lt;/dd>
<span class='linenumber'>195</span>    *    &lt;dt>source-over&lt;/dt>&lt;dd>&lt;/dd>
<span class='linenumber'>196</span>    *    &lt;dt>destination-atop&lt;/dt>&lt;dd>&lt;/dd>
<span class='linenumber'>197</span>    *    &lt;dt>destination-in&lt;/dt>&lt;dd>&lt;/dd>
<span class='linenumber'>198</span>    *    &lt;dt>destination-out&lt;/dt>&lt;dd>&lt;/dd>
<span class='linenumber'>199</span>    *    &lt;dt>destination-over&lt;/dt>&lt;dd>&lt;/dd>
<span class='linenumber'>200</span>    *    &lt;dt>lighter&lt;/dt>&lt;dd>&lt;/dd>
<span class='linenumber'>201</span>    *    &lt;dt>copy&lt;/dt>&lt;dd>&lt;/dd>
<span class='linenumber'>202</span>    *    &lt;dt>xor&lt;/dt>&lt;dd>&lt;/dd>
<span class='linenumber'>203</span>    *  &lt;/dl>
<span class='linenumber'>204</span>    * @return this - thisを返します。
<span class='linenumber'>205</span>    */</span><span class="WHIT">
<span class='linenumber'>206</span> </span><span class="WHIT">  </span><span class="NAME">mix</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">method</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>207</span> </span><span class="WHIT">    </span><span class="NAME">this._cmdRec</span><span class="PUNC">(</span><span class="STRN">"mix"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">method</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>208</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._mix</span><span class="PUNC">(</span><span class="NAME">method</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>209</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>210</span> </span><span class="WHIT">  </span><span class="COMM">/** &lt;b>uu.module.context2dDebug.begin - アルファブレンドの値を指定&lt;/b>
<span class='linenumber'>211</span>    *
<span class='linenumber'>212</span>    * @param number alpha - アルファブレンド値を0.0～1.0の値で指定します。不透明度(opacity)と同様です。
<span class='linenumber'>213</span>    * @return this - thisを返します。
<span class='linenumber'>214</span>    */</span><span class="WHIT">
<span class='linenumber'>215</span> </span><span class="WHIT">  </span><span class="NAME">alpha</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">alpha</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>216</span> </span><span class="WHIT">    </span><span class="NAME">this._cmdRec</span><span class="PUNC">(</span><span class="STRN">"alpha"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">alpha</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>217</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._alpha</span><span class="PUNC">(</span><span class="NAME">alpha</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>218</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>219</span> </span><span class="WHIT">  </span><span class="COMM">/** &lt;b>uu.module.context2dDebug.begin - クリア&lt;/b>
<span class='linenumber'>220</span>    * 指定した範囲をクリアします。引数を全て省略すると全体をクリアします。
<span class='linenumber'>221</span>    *
<span class='linenumber'>222</span>    * @param number [x] - x座標を指定します。
<span class='linenumber'>223</span>    * @param number [y] - y座標を指定します。
<span class='linenumber'>224</span>    * @param number [w] - 幅を指定します。負の値も指定可能です。
<span class='linenumber'>225</span>    * @param number [h] - 高さを指定します。負の値も指定可能です。
<span class='linenumber'>226</span>    * @return this - thisを返します。
<span class='linenumber'>227</span>    */</span><span class="WHIT">
<span class='linenumber'>228</span> </span><span class="WHIT">  </span><span class="NAME">clear</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>229</span> </span><span class="WHIT">    </span><span class="NAME">this._cmdRec</span><span class="PUNC">(</span><span class="STRN">"clear"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>230</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._clear</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>231</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>232</span> </span><span class="WHIT">  </span><span class="COMM">/** &lt;b>uu.module.context2dDebug.begin - サブパスの初期化と開始&lt;/b>
<span class='linenumber'>233</span>    *
<span class='linenumber'>234</span>    * コンテキストのサブパスを全てクリアし、新しいサブパスを開始します。&lt;br />
<span class='linenumber'>235</span>    * x,y座標が指定されている場合は、その座標まで移動しサブパスの出発点とします。
<span class='linenumber'>236</span>    *
<span class='linenumber'>237</span>    * &lt;pre class="eg">
<span class='linenumber'>238</span>    * var ctx = new uu.module.context2dDebug(uu.canvas.context(uu.canvas.create()));
<span class='linenumber'>239</span>    * ctx.begin(100, 100, 1).  // サブパス開始, (100,100)に移動
<span class='linenumber'>240</span>    *     line(20, 0).         // (120, 100)に線を引きながら移動
<span class='linenumber'>241</span>    *     line(-20, 0).        // ( 90, 120)に線を引きながら移動
<span class='linenumber'>242</span>    *     close(200, 100, 1).  // サブパスをクローズ(暗黙で100,100と90,120の間に線が引かれる)し、(200,100)に移動
<span class='linenumber'>243</span>    *     line(10, 20).        // (210, 120)に線を引きながら移動
<span class='linenumber'>244</span>    *     line(-20, 0).        // (190, 120)に線を引きながら移動
<span class='linenumber'>245</span>    *     stroke();            // サブパスを描画
<span class='linenumber'>246</span>    * &lt;/pre>
<span class='linenumber'>247</span>    *
<span class='linenumber'>248</span>    * @param number [x] - 移動先のx絶対座標を指定します。デフォルトはundefinedです。
<span class='linenumber'>249</span>    * @param number [y] - 移動先のy絶対座標を指定します。デフォルトはundefinedです。
<span class='linenumber'>250</span>    * @return this - thisを返します。
<span class='linenumber'>251</span>    * @see &lt;a href="#begin">uu.module.context2dDebug.begin()&lt;/a> - サブパスの初期化と開始
<span class='linenumber'>252</span>    * @see &lt;a href="#close">uu.module.context2dDebug.close()&lt;/a> - 現在のサブパスを閉じ、新しいサブパスを開始
<span class='linenumber'>253</span>    * @see &lt;a href="#move">uu.module.context2dDebug.close()&lt;/a> - サブパスの移動
<span class='linenumber'>254</span>    * @see &lt;a href="#line">uu.module.context2dDebug.line()&lt;/a> - 直接を引きつつサブパスを移動
<span class='linenumber'>255</span>    * @see &lt;a href="#fill">uu.module.context2dDebug.fill()&lt;/a> - サブパスを塗りつぶす
<span class='linenumber'>256</span>    * @see &lt;a href="#rect">uu.module.context2dDebug.rect()&lt;/a> - スクエア(四角)のサブパスを追加
<span class='linenumber'>257</span>    * @see &lt;a href="#drawBox">uu.module.context2dDebug.drawBox()&lt;/a> - ボックスを描画
<span class='linenumber'>258</span>    */</span><span class="WHIT">
<span class='linenumber'>259</span> </span><span class="WHIT">  </span><span class="NAME">begin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">x</span><span class="WHIT"> </span><span class="COMM">/* = undefined */</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="WHIT"> </span><span class="COMM">/* = undefined */</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'>260</span> </span><span class="WHIT">    </span><span class="NAME">this._cmdRec</span><span class="PUNC">(</span><span class="STRN">"begin"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>261</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._begin</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>262</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>263</span> </span><span class="WHIT">  </span><span class="COMM">/** &lt;b>uu.module.context2dDebug.close - 現在のサブパスを閉じ、新しいサブパスを開始&lt;/b>
<span class='linenumber'>264</span>    *
<span class='linenumber'>265</span>    * カレントのサブパスを閉じ、新しいサブパスを開始します。&lt;br />
<span class='linenumber'>266</span>    * x,y座標が指定されている場合は、その座標まで移動しサブパスの出発点とします。
<span class='linenumber'>267</span>    *
<span class='linenumber'>268</span>    * @param number [x] - 移動先のx座標を指定します。デフォルトはundefinedです。
<span class='linenumber'>269</span>    * @param number [y] - 移動先のy座標を指定します。デフォルトはundefinedです。
<span class='linenumber'>270</span>    * @return this - thisを返します。
<span class='linenumber'>271</span>    * @see &lt;a href="#begin">uu.module.context2dDebug.begin()&lt;/a> - サブパスの初期化と開始
<span class='linenumber'>272</span>    * @see &lt;a href="#close">uu.module.context2dDebug.close()&lt;/a> - 現在のサブパスを閉じ、新しいサブパスを開始
<span class='linenumber'>273</span>    * @see &lt;a href="#move">uu.module.context2dDebug.close()&lt;/a> - サブパスの移動
<span class='linenumber'>274</span>    * @see &lt;a href="#line">uu.module.context2dDebug.line()&lt;/a> - 直接を引きつつサブパスを移動
<span class='linenumber'>275</span>    * @see &lt;a href="#fill">uu.module.context2dDebug.fill()&lt;/a> - サブパスを塗りつぶす
<span class='linenumber'>276</span>    * @see &lt;a href="#rect">uu.module.context2dDebug.rect()&lt;/a> - スクエア(四角)のサブパスを追加
<span class='linenumber'>277</span>    * @see &lt;a href="#drawBox">uu.module.context2dDebug.drawBox()&lt;/a> - ボックスを描画
<span class='linenumber'>278</span>    */</span><span class="WHIT">
<span class='linenumber'>279</span> </span><span class="WHIT">  </span><span class="NAME">close</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">x</span><span class="WHIT"> </span><span class="COMM">/* = undefined */</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="WHIT"> </span><span class="COMM">/* = undefined */</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>280</span> </span><span class="WHIT">    </span><span class="NAME">this._cmdRec</span><span class="PUNC">(</span><span class="STRN">"close"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>281</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._close</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>282</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>283</span> </span><span class="WHIT">  </span><span class="COMM">/** &lt;b>uu.module.context2dDebug.move - サブパスの移動&lt;/b>
<span class='linenumber'>284</span>    *
<span class='linenumber'>285</span>    * カレントのサブパスを移動させます。&lt;br />
<span class='linenumber'>286</span>    * move()で移動すると、線として描画されません。
<span class='linenumber'>287</span>    *
<span class='linenumber'>288</span>    * @param number x - 移動先のx座標を指定します。
<span class='linenumber'>289</span>    * @param number y - 移動先のy座標を指定します。
<span class='linenumber'>290</span>    * @return this - thisを返します。
<span class='linenumber'>291</span>    * @see &lt;a href="#begin">uu.module.context2dDebug.begin()&lt;/a> - サブパスの初期化と開始
<span class='linenumber'>292</span>    * @see &lt;a href="#close">uu.module.context2dDebug.close()&lt;/a> - 現在のサブパスを閉じ、新しいサブパスを開始
<span class='linenumber'>293</span>    * @see &lt;a href="#move">uu.module.context2dDebug.close()&lt;/a> - サブパスの移動
<span class='linenumber'>294</span>    * @see &lt;a href="#line">uu.module.context2dDebug.line()&lt;/a> - 直接を引きつつサブパスを移動
<span class='linenumber'>295</span>    * @see &lt;a href="#fill">uu.module.context2dDebug.fill()&lt;/a> - サブパスを塗りつぶす
<span class='linenumber'>296</span>    * @see &lt;a href="#rect">uu.module.context2dDebug.rect()&lt;/a> - スクエア(四角)のサブパスを追加
<span class='linenumber'>297</span>    * @see &lt;a href="#drawBox">uu.module.context2dDebug.drawBox()&lt;/a> - ボックスを描画
<span class='linenumber'>298</span>    */</span><span class="WHIT">
<span class='linenumber'>299</span> </span><span class="WHIT">  </span><span class="NAME">move</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>300</span> </span><span class="WHIT">    </span><span class="NAME">this._cmdRec</span><span class="PUNC">(</span><span class="STRN">"move"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>301</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._move</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>302</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>303</span> </span><span class="WHIT">  </span><span class="COMM">/** &lt;b>uu.module.context2dDebug.line - 直接を引きつつサブパスを移動&lt;/b>
<span class='linenumber'>304</span>    *
<span class='linenumber'>305</span>    * カレントのサブパスをx,y座標に移動させ、始点から終点まで線を引きます。&lt;br />
<span class='linenumber'>306</span>    * line()で移動するとstoroke()で線が描画されます。&lt;br />
<span class='linenumber'>307</span>    * サブパスが存在しない場合は、何もしません。
<span class='linenumber'>308</span>    *
<span class='linenumber'>309</span>    * @param array point - 移動先のx,y座標を指定します。&lt;br />
<span class='linenumber'>310</span>    *                      [x1, y1, x2, y2, ... ] 形式で複数の頂点を指定できます。
<span class='linenumber'>311</span>    * @param hash [style] - ラインスタイルを指定します。デフォルトはundefinedです。
<span class='linenumber'>312</span>    * @return this - thisを返します。
<span class='linenumber'>313</span>    * @see &lt;a href="#begin">uu.module.context2dDebug.begin()&lt;/a> - サブパスの初期化と開始
<span class='linenumber'>314</span>    * @see &lt;a href="#close">uu.module.context2dDebug.close()&lt;/a> - 現在のサブパスを閉じ、新しいサブパスを開始
<span class='linenumber'>315</span>    * @see &lt;a href="#move">uu.module.context2dDebug.close()&lt;/a> - サブパスの移動
<span class='linenumber'>316</span>    * @see &lt;a href="#line">uu.module.context2dDebug.line()&lt;/a> - 直接を引きつつサブパスを移動
<span class='linenumber'>317</span>    * @see &lt;a href="#fill">uu.module.context2dDebug.fill()&lt;/a> - サブパスを塗りつぶす
<span class='linenumber'>318</span>    * @see &lt;a href="#rect">uu.module.context2dDebug.rect()&lt;/a> - スクエア(四角)のサブパスを追加
<span class='linenumber'>319</span>    * @see &lt;a href="#drawBox">uu.module.context2dDebug.drawBox()&lt;/a> - ボックスを描画
<span class='linenumber'>320</span>    */</span><span class="WHIT">
<span class='linenumber'>321</span> </span><span class="WHIT">  </span><span class="NAME">line</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">point</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">style</span><span class="WHIT"> </span><span class="COMM">/* = undefined */</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>322</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">uu.isA</span><span class="PUNC">(</span><span class="NAME">point</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">poing.length</span><span class="WHIT"> </span><span class="PUNC">%</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="NAME">TypeError</span><span class="PUNC">(</span><span class="STRN">"uu.module.context2dDebug.line(point)"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>323</span> </span><span class="WHIT">    </span><span class="NAME">this._cmdRec</span><span class="PUNC">(</span><span class="STRN">"line"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">point</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">style</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>324</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._line</span><span class="PUNC">(</span><span class="NAME">point</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">style</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>325</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>326</span> </span><span class="WHIT">  </span><span class="COMM">/** &lt;b>uu.module.context2dDebug.arcLine - 円弧のサブパスを作成しパスを移動する&lt;/b>
<span class='linenumber'>327</span>    *
<span class='linenumber'>328</span>    * カレントのサブパスの終点(ペン座標)から(x1,y1)までの直線をAとし、&lt;br />
<span class='linenumber'>329</span>    * (x1,y1)から(x2,y2)までの直線をBとした場合に、AとBに接する円弧のパスを作成します。&lt;br />
<span class='linenumber'>330</span>    * また、サブパスの終点から円弧の始点まで直線を引きます。&lt;br />
<span class='linenumber'>331</span>    * カレントのサブパスが存在しない場合は、何もしません。&lt;br />
<span class='linenumber'>332</span>    *
<span class='linenumber'>333</span>    * Safari以外のブラウザでは描画結果が仕様どおりに描画されないため、このメソッドは使用不能です。&lt;br />
<span class='linenumber'>334</span>    *
<span class='linenumber'>335</span>    * &lt;pre class="eg">
<span class='linenumber'>336</span>    * 　　 b　c
<span class='linenumber'>337</span>    * 　　／⌒＼
<span class='linenumber'>338</span>    * 　／A 　 B＼
<span class='linenumber'>339</span>    *  a　　　　　d
<span class='linenumber'>340</span>    * var ctx = new uu.module.context2dDebug(uu.canvas.context(uu.canvas.create()));
<span class='linenumber'>341</span>    * ctx.begin(0, 200, 1).                      // サブパス開始, a(0,200)に移動
<span class='linenumber'>342</span>    *     arcLine([100, 100, 200, 200], 1, 40).  // a(0,200)から円弧の始点(約75,75)まで直線を引き、
<span class='linenumber'>343</span>    *                                            // 円弧を作成する
<span class='linenumber'>344</span>    *     line(200,200, 1).                      // 円弧の終点(約125,125)からd(200,200)までの直線を引く
<span class='linenumber'>345</span>    *     stroke();                              // サブパスを描画
<span class='linenumber'>346</span>    * &lt;/pre>
<span class='linenumber'>347</span>    *
<span class='linenumber'>348</span>    * @param array point - 移動先のx,y座標を指定します。&lt;br />
<span class='linenumber'>349</span>    *                      [x1, y1, x2, y2, ... ] 形式で複数の頂点を指定できます。
<span class='linenumber'>350</span>    * @param number [r] - 半径を指定します。デフォルトは100です。
<span class='linenumber'>351</span>    * @param hash [style] - ラインスタイルを指定します。デフォルトはundefinedです。
<span class='linenumber'>352</span>    * @return this - thisを返します。
<span class='linenumber'>353</span>    * @see &lt;a href="#begin">uu.module.context2dDebug.begin()&lt;/a> - サブパスの初期化と開始
<span class='linenumber'>354</span>    * @see &lt;a href="#close">uu.module.context2dDebug.close()&lt;/a> - 現在のサブパスを閉じ、新しいサブパスを開始
<span class='linenumber'>355</span>    * @see &lt;a href="#move">uu.module.context2dDebug.close()&lt;/a> - サブパスの移動
<span class='linenumber'>356</span>    * @see &lt;a href="#line">uu.module.context2dDebug.line()&lt;/a> - 直接を引きつつサブパスを移動
<span class='linenumber'>357</span>    * @see &lt;a href="#fill">uu.module.context2dDebug.fill()&lt;/a> - サブパスを塗りつぶす
<span class='linenumber'>358</span>    * @see &lt;a href="#rect">uu.module.context2dDebug.rect()&lt;/a> - スクエア(四角)のサブパスを追加
<span class='linenumber'>359</span>    * @see &lt;a href="#drawBox">uu.module.context2dDebug.drawBox()&lt;/a> - ボックスを描画
<span class='linenumber'>360</span>    * @ignore
<span class='linenumber'>361</span>    */</span><span class="WHIT">
<span class='linenumber'>362</span> </span><span class="WHIT">  </span><span class="NAME">arcLine</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">point</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">r</span><span class="WHIT"> </span><span class="COMM">/* = 100 */</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">style</span><span class="WHIT"> </span><span class="COMM">/* = undefined */</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>363</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">uu.isA</span><span class="PUNC">(</span><span class="NAME">point</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">poing.length</span><span class="WHIT"> </span><span class="PUNC">%</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="NAME">TypeError</span><span class="PUNC">(</span><span class="STRN">"uu.module.context2dDebug.arcLine(point)"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>364</span> </span><span class="WHIT">    </span><span class="NAME">this._cmdRec</span><span class="PUNC">(</span><span class="STRN">"arcLine"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">point</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">style</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>365</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._arcTo</span><span class="PUNC">(</span><span class="NAME">point</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">style</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>366</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>367</span> </span><span class="WHIT">  </span><span class="COMM">/** &lt;b>uu.module.context2dDebug.fill - サブパスを塗りつぶす&lt;/b>
<span class='linenumber'>368</span>    *
<span class='linenumber'>369</span>    * サブパスを塗りつぶします。&lt;br />
<span class='linenumber'>370</span>    * サブパスが閉じていない場合(close)はサブパスを一旦閉じてから塗りつぶします。
<span class='linenumber'>371</span>    * (塗りつぶしが終わったらサブパスを元の閉じていない状態に戻します。)&lt;br />&lt;br />
<span class='linenumber'>372</span>    *
<span class='linenumber'>373</span>    * wireにtrueを指定すると、サブパスに沿ってワイヤーを描画します。
<span class='linenumber'>374</span>    *
<span class='linenumber'>375</span>    * @param number/bool [wire] - ワイヤーを描画する場合はtrueか1を指定します。塗りつぶす場合はfalseか0を指定します。
<span class='linenumber'>376</span>    *                             デフォルトは0です。
<span class='linenumber'>377</span>    * @param fillStyle/strokeStyle [style] - フィルスタイル(塗りつぶし用)または、
<span class='linenumber'>378</span>    *                                        ストロークスタイル(ワイヤー用)を指定します。
<span class='linenumber'>379</span>    *                                        デフォルトはundefinedです。
<span class='linenumber'>380</span>    * @return this - thisを返します。
<span class='linenumber'>381</span>    * @see &lt;a href="#begin">uu.module.context2dDebug.begin()&lt;/a> - サブパスの初期化と開始
<span class='linenumber'>382</span>    * @see &lt;a href="#close">uu.module.context2dDebug.close()&lt;/a> - 現在のサブパスを閉じ、新しいサブパスを開始
<span class='linenumber'>383</span>    * @see &lt;a href="#move">uu.module.context2dDebug.close()&lt;/a> - サブパスの移動
<span class='linenumber'>384</span>    * @see &lt;a href="#line">uu.module.context2dDebug.line()&lt;/a> - 直接を引きつつサブパスを移動
<span class='linenumber'>385</span>    * @see &lt;a href="#fill">uu.module.context2dDebug.fill()&lt;/a> - サブパスを塗りつぶす
<span class='linenumber'>386</span>    * @see &lt;a href="#rect">uu.module.context2dDebug.rect()&lt;/a> - スクエア(四角)のサブパスを追加
<span class='linenumber'>387</span>    * @see &lt;a href="#drawBox">uu.module.context2dDebug.drawBox()&lt;/a> - ボックスを描画
<span class='linenumber'>388</span>    */</span><span class="WHIT">
<span class='linenumber'>389</span> </span><span class="WHIT">  </span><span class="NAME">fill</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">wire</span><span class="WHIT"> </span><span class="COMM">/* = false */</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">style</span><span class="WHIT"> </span><span class="COMM">/* = undefined */</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>390</span> </span><span class="WHIT">    </span><span class="NAME">this._cmdRec</span><span class="PUNC">(</span><span class="STRN">"fill"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">wire</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">style</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>391</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">wire</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>392</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._stroke</span><span class="PUNC">(</span><span class="NAME">style</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>393</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>394</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._fill</span><span class="PUNC">(</span><span class="NAME">style</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>395</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>396</span> </span><span class="WHIT">  </span><span class="COMM">/** &lt;b>uu.module.context2dDebug.rect - スクエア(四角)のサブパスを追加&lt;/b>
<span class='linenumber'>397</span>    *
<span class='linenumber'>398</span>    * (x,y)を基点にスクエア(四角)状のサブパスを作成します。&lt;br />
<span class='linenumber'>399</span>    * 次に作成したサブパスを閉じ(close)、&lt;br />
<span class='linenumber'>400</span>    * 新しいサブパスを開始して(x,y)に移動します。&lt;br />&lt;br />
<span class='linenumber'>401</span>    *
<span class='linenumber'>402</span>    * このメソッドは、move + line のコンビニエンスメソッドです。&lt;br />
<span class='linenumber'>403</span>    *
<span class='linenumber'>404</span>    * 未確認: すでにサブパスが存在する場合は破棄される? それとも一旦閉じられそのまま存続する?
<span class='linenumber'>405</span>    *
<span class='linenumber'>406</span>    * @param number x - 移動先のx座標を指定します。
<span class='linenumber'>407</span>    * @param number y - 移動先のy座標を指定します。
<span class='linenumber'>408</span>    * @param number w - 幅を指定します。
<span class='linenumber'>409</span>    * @param number h - 高さを指定します。
<span class='linenumber'>410</span>    * @param hash [style] - ラインスタイルを指定します。デフォルトはundefinedです。
<span class='linenumber'>411</span>    * @return this - thisを返します。
<span class='linenumber'>412</span>    * @see &lt;a href="#begin">uu.module.context2dDebug.begin()&lt;/a> - サブパスの初期化と開始
<span class='linenumber'>413</span>    * @see &lt;a href="#close">uu.module.context2dDebug.close()&lt;/a> - 現在のサブパスを閉じ、新しいサブパスを開始
<span class='linenumber'>414</span>    * @see &lt;a href="#move">uu.module.context2dDebug.close()&lt;/a> - サブパスの移動
<span class='linenumber'>415</span>    * @see &lt;a href="#line">uu.module.context2dDebug.line()&lt;/a> - 直接を引きつつサブパスを移動
<span class='linenumber'>416</span>    * @see &lt;a href="#fill">uu.module.context2dDebug.fill()&lt;/a> - サブパスを塗りつぶす
<span class='linenumber'>417</span>    * @see &lt;a href="#rect">uu.module.context2dDebug.rect()&lt;/a> - スクエア(四角)のサブパスを追加
<span class='linenumber'>418</span>    * @see &lt;a href="#drawBox">uu.module.context2dDebug.drawBox()&lt;/a> - ボックスを描画
<span class='linenumber'>419</span>    */</span><span class="WHIT">
<span class='linenumber'>420</span> </span><span class="WHIT">  </span><span class="NAME">rect</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">style</span><span class="WHIT"> </span><span class="COMM">/* = undefined */</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>421</span> </span><span class="WHIT">    </span><span class="NAME">this._cmdRec</span><span class="PUNC">(</span><span class="STRN">"rect"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">style</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>422</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._rect</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">style</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>423</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>424</span> </span><span class="WHIT">  </span><span class="COMM">/** &lt;b>uu.module.context2dDebug.rect - 円弧のサブパスを追加&lt;/b>
<span class='linenumber'>425</span>    *
<span class='linenumber'>426</span>    * (x,y)を中心とする円弧状のサブパスを作成します。&lt;br />
<span class='linenumber'>427</span>    * 既にサブパスが存在する場合は、円弧の始点まで直線のパスが自動的に追加されます。&lt;br />
<span class='linenumber'>428</span>    *
<span class='linenumber'>429</span>    * @param number x - 円弧の中心を指定します。
<span class='linenumber'>430</span>    * @param number y - 円弧の中心を指定します。
<span class='linenumber'>431</span>    * @param hash [style] - ラインスタイルを指定します。デフォルトはundefinedです。
<span class='linenumber'>432</span>    * @param hash [param] - パラメタを指定します。
<span class='linenumber'>433</span>    * @param number [param.r] - 半径を指定します。デフォルトは100です。
<span class='linenumber'>434</span>    * @param number [param.a0] - 開始角度を0～359の数値で指定します。デフォルトは0です。
<span class='linenumber'>435</span>    * @param number [param.a1] - 終了角度を0～359の数値で指定します。デフォルトは359です。
<span class='linenumber'>436</span>    * @param number [param.clock] - 時計周りにパスを設定する場合はtrueを、反時計回りならfalseを指定します。
<span class='linenumber'>437</span>    * @return this - thisを返します。
<span class='linenumber'>438</span>    * @see &lt;a href="#begin">uu.module.context2dDebug.begin()&lt;/a> - サブパスの初期化と開始
<span class='linenumber'>439</span>    * @see &lt;a href="#close">uu.module.context2dDebug.close()&lt;/a> - 現在のサブパスを閉じ、新しいサブパスを開始
<span class='linenumber'>440</span>    * @see &lt;a href="#move">uu.module.context2dDebug.close()&lt;/a> - サブパスの移動
<span class='linenumber'>441</span>    * @see &lt;a href="#line">uu.module.context2dDebug.line()&lt;/a> - 直接を引きつつサブパスを移動
<span class='linenumber'>442</span>    * @see &lt;a href="#fill">uu.module.context2dDebug.fill()&lt;/a> - サブパスを塗りつぶす
<span class='linenumber'>443</span>    * @see &lt;a href="#rect">uu.module.context2dDebug.rect()&lt;/a> - スクエア(四角)のサブパスを追加
<span class='linenumber'>444</span>    * @see &lt;a href="#drawBox">uu.module.context2dDebug.drawBox()&lt;/a> - ボックスを描画
<span class='linenumber'>445</span>    */</span><span class="WHIT">
<span class='linenumber'>446</span> </span><span class="WHIT">  </span><span class="NAME">arc</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">param</span><span class="WHIT"> </span><span class="COMM">/* = { r: 100, a0: 0, a1: 359, clock: true } */</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">style</span><span class="WHIT"> </span><span class="COMM">/* = undefined */</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>447</span> </span><span class="WHIT">    </span><span class="NAME">this._cmdRec</span><span class="PUNC">(</span><span class="STRN">"arc"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">param</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">style</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>448</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._arc</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">param</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">style</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>449</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>450</span> </span><span class="WHIT">  </span><span class="COMM">/** &lt;b>uu.module.context2dDebug.curve - カーブを引きつつサブパスを移動&lt;/b>
<span class='linenumber'>451</span>    *
<span class='linenumber'>452</span>    * カレントのサブパスの終点(ペン座標)とx,y座標を結ぶカーブをパスに追加し、&lt;br />
<span class='linenumber'>453</span>    * x,y座標にパスを移動します。&lt;br />
<span class='linenumber'>454</span>    * サブパスが存在しない場合は、何もしません。
<span class='linenumber'>455</span>    *
<span class='linenumber'>456</span>    * @param array point - 制御点と移動先のx,y座標を指定します。&lt;br />
<span class='linenumber'>457</span>    *                      ベジェ曲線なら、[cp1x, cp1y, cp2x, cp2y, x, y ] 形式で座標を指定します。&lt;br />
<span class='linenumber'>458</span>    *                      二次曲線なら、[cp1x, cp1y, x, y ] 形式で座標を指定します。
<span class='linenumber'>459</span>    * @param number/bool [bezier] - ベジェ曲線を使用するならtrueか1を指定します。
<span class='linenumber'>460</span>    *                               二次曲線を使用するならfalseか0を指定します。&lt;br />
<span class='linenumber'>461</span>    *                               デフォルトは1です。
<span class='linenumber'>462</span>    * @param hash [style] - ラインスタイルを指定します。デフォルトはundefinedです。
<span class='linenumber'>463</span>    * @return this - thisを返します。
<span class='linenumber'>464</span>    */</span><span class="WHIT">
<span class='linenumber'>465</span> </span><span class="WHIT">  </span><span class="NAME">curve</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">point</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">bezier</span><span class="WHIT"> </span><span class="COMM">/* = 1 */</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">style</span><span class="WHIT"> </span><span class="COMM">/* = undefined */</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>466</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">uu.isA</span><span class="PUNC">(</span><span class="NAME">point</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">poing.length</span><span class="WHIT"> </span><span class="PUNC">%</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="NAME">TypeError</span><span class="PUNC">(</span><span class="STRN">"uu.module.context2dDebug.curve(point)"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>467</span> </span><span class="WHIT">    </span><span class="NAME">this._cmdRec</span><span class="PUNC">(</span><span class="STRN">"curve"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">point</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">bezier</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">style</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>468</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._curve</span><span class="PUNC">(</span><span class="NAME">point</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">bezier</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">style</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>469</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>470</span> </span><span class="WHIT">  </span><span class="COMM">/** &lt;b>uu.module.context2dDebug.clip - クリッピングパスの設定&lt;/b>
<span class='linenumber'>471</span>    *
<span class='linenumber'>472</span>    * カレントパスを元に、クリッピングパス(マスク)を生成し、コンテキストに適用します。&lt;br />
<span class='linenumber'>473</span>    * 一度生成したクリッピングパスは、begin()やreset()を実行するまで有効です。
<span class='linenumber'>474</span>    */</span><span class="WHIT">
<span class='linenumber'>475</span> </span><span class="WHIT">  </span><span class="NAME">clip</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>476</span> </span><span class="WHIT">    </span><span class="NAME">this.clip</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>477</span> </span><span class="WHIT">    </span><span class="NAME">this._cmdRec</span><span class="PUNC">(</span><span class="STRN">"clip"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>478</span> </span><span class="WHIT">    </span><span class="NAME">this.ctx.clip</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>479</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>480</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>481</span> </span><span class="WHIT">  </span><span class="COMM">/** &lt;b>uu.module.context2dDebug.drawBox - ボックスを描画&lt;/b>
<span class='linenumber'>482</span>    *
<span class='linenumber'>483</span>    * (x,y)を基点にスクエア(四角)状のボックスを追加します。&lt;br />
<span class='linenumber'>484</span>    * fillにtrueを指定すると塗りつぶされたボックスを、falseを指定するとワイヤーを描画します。
<span class='linenumber'>485</span>    *
<span class='linenumber'>486</span>    * このメソッドは、move + line + fill or storoke のコンビニエンスメソッドとも言えますが、
<span class='linenumber'>487</span>    * 既存のサブパスにはなんら影響を及ぼしません。&lt;br />
<span class='linenumber'>488</span>    *
<span class='linenumber'>489</span>    * @param number x - 移動先のx座標を指定します。
<span class='linenumber'>490</span>    * @param number y - 移動先のy座標を指定します。
<span class='linenumber'>491</span>    * @param number w - 幅を指定します。
<span class='linenumber'>492</span>    * @param number h - 高さを指定します。
<span class='linenumber'>493</span>    * @param number/bool [wire] - ワイヤーを描画する場合はtrueか1を指定します。塗りつぶす場合はfalseか0を指定します。
<span class='linenumber'>494</span>    *                             デフォルトは0です。
<span class='linenumber'>495</span>    * @param fillStyle/storokeStyle [style] - フィルスタイルまたはストロークスタイルを指定します。デフォルトはundefinedです。
<span class='linenumber'>496</span>    * @return this - thisを返します。
<span class='linenumber'>497</span>    * @see &lt;a href="#begin">uu.module.context2dDebug.begin()&lt;/a> - サブパスの初期化と開始
<span class='linenumber'>498</span>    * @see &lt;a href="#close">uu.module.context2dDebug.close()&lt;/a> - 現在のサブパスを閉じ、新しいサブパスを開始
<span class='linenumber'>499</span>    * @see &lt;a href="#move">uu.module.context2dDebug.close()&lt;/a> - サブパスの移動
<span class='linenumber'>500</span>    * @see &lt;a href="#line">uu.module.context2dDebug.line()&lt;/a> - 直接を引きつつサブパスを移動
<span class='linenumber'>501</span>    * @see &lt;a href="#fill">uu.module.context2dDebug.fill()&lt;/a> - サブパスを塗りつぶす
<span class='linenumber'>502</span>    * @see &lt;a href="#rect">uu.module.context2dDebug.rect()&lt;/a> - スクエア(四角)のサブパスを追加
<span class='linenumber'>503</span>    * @see &lt;a href="#drawBox">uu.module.context2dDebug.drawBox()&lt;/a> - ボックスを描画
<span class='linenumber'>504</span>    */</span><span class="WHIT">
<span class='linenumber'>505</span> </span><span class="WHIT">  </span><span class="NAME">drawBox</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">wire</span><span class="WHIT"> </span><span class="COMM">/* = 0 */</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">style</span><span class="WHIT"> </span><span class="COMM">/* = undefined */</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>506</span> </span><span class="WHIT">    </span><span class="NAME">this._cmdRec</span><span class="PUNC">(</span><span class="STRN">"box"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">fill</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">style</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>507</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">wire</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>508</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._storokeRect</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">style</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>509</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>510</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._fillRect</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">style</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>511</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>512</span> </span><span class="WHIT">  </span><span class="COMM">/** &lt;b>uu.module.context2dDebug.zoom - 拡大縮小率の設定&lt;/b>
<span class='linenumber'>513</span>    *
<span class='linenumber'>514</span>    * 拡大縮小率(スケール)を設定します。
<span class='linenumber'>515</span>    *
<span class='linenumber'>516</span>    * @param number x - 水平方向のzoom値を指定します。2で2倍になり、0.5で1/2になります。
<span class='linenumber'>517</span>    * @param number y - 垂直方向のzoom値を指定します。2で2倍になり、0.5で1/2になります。
<span class='linenumber'>518</span>    * @return this - thisを返します。
<span class='linenumber'>519</span>    */</span><span class="WHIT">
<span class='linenumber'>520</span> </span><span class="WHIT">  </span><span class="NAME">zoom</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>521</span> </span><span class="WHIT">    </span><span class="NAME">this._cmdRec</span><span class="PUNC">(</span><span class="STRN">"zoom"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>522</span> </span><span class="WHIT">    </span><span class="NAME">this.zoom</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>523</span> </span><span class="WHIT">    </span><span class="NAME">this.zoom</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>524</span> </span><span class="WHIT">    </span><span class="NAME">this.ctx.scale</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>525</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>526</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>527</span> </span><span class="WHIT">  </span><span class="COMM">/** &lt;b>uu.module.context2dDebug.offset - オフセット座標の設定&lt;/b>
<span class='linenumber'>528</span>    *
<span class='linenumber'>529</span>    * 原点をずらします。scale(1,1)の時、オフセット値1は1pxに相当します。
<span class='linenumber'>530</span>    *
<span class='linenumber'>531</span>    * @param number x - 水平方向のオフセット値を指定します。
<span class='linenumber'>532</span>    * @param number y - 垂直方向のオフセット値を指定します。
<span class='linenumber'>533</span>    * @return this - thisを返します。
<span class='linenumber'>534</span>    */</span><span class="WHIT">
<span class='linenumber'>535</span> </span><span class="WHIT">  </span><span class="NAME">offset</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>536</span> </span><span class="WHIT">    </span><span class="NAME">this._cmdRec</span><span class="PUNC">(</span><span class="STRN">"offset"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>537</span> </span><span class="WHIT">    </span><span class="NAME">this.offset</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>538</span> </span><span class="WHIT">    </span><span class="NAME">this.offset</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>539</span> </span><span class="WHIT">    </span><span class="NAME">this.ctx.translate</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>540</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>541</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>542</span> </span><span class="WHIT">  </span><span class="COMM">/** &lt;b>uu.module.context2dDebug.rotate - キャンバスの回転&lt;/b>
<span class='linenumber'>543</span>    *
<span class='linenumber'>544</span>    * キャンバス(コンテキスト)を回転させます。
<span class='linenumber'>545</span>    *
<span class='linenumber'>546</span>    * @param number angle - 回転を度数(0～359)で指定します。0が正位置です。
<span class='linenumber'>547</span>    * @return this - thisを返します。
<span class='linenumber'>548</span>    */</span><span class="WHIT">
<span class='linenumber'>549</span> </span><span class="WHIT">  </span><span class="NAME">rotate</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">angle</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>550</span> </span><span class="WHIT">    </span><span class="NAME">this._cmdRec</span><span class="PUNC">(</span><span class="STRN">"rotate"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">angle</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>551</span> </span><span class="WHIT">    </span><span class="NAME">this.rotate</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">angle</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>552</span> </span><span class="WHIT">    </span><span class="NAME">this.ctx.rotate</span><span class="PUNC">(</span><span class="NAME">angle</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">Math.RADIAN</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>553</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>554</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>555</span> </span><span class="COMM">//  inPath: function(x, y) { return this.ctx.isPointInPath(x, y); },</span><span class="WHIT">
<span class='linenumber'>556</span> 
<span class='linenumber'>557</span> </span><span class="WHIT">  </span><span class="COMM">/** &lt;b>uu.module.context2dDebug.gradation - グラデーションの作成&lt;/b>
<span class='linenumber'>558</span>    *
<span class='linenumber'>559</span>    * グラデーションを作成します。
<span class='linenumber'>560</span>    *
<span class='linenumber'>561</span>    * @param array point - 始点(x0,y0)と終点(x1,y1)の座標を指定します。&lt;br />
<span class='linenumber'>562</span>    *                      線形グラデーションでは、[x0, y0, x1, y1] の形式で指定します。&lt;br />
<span class='linenumber'>563</span>    *                      円形グラデーションでは、[x0, y0, r0, x1, y1, r1] の形式で指定します。&lt;br />
<span class='linenumber'>564</span>    * @param bool/number [line] - 線形グラデーションを作成する場合はtrueか1を指定します。
<span class='linenumber'>565</span>    *                             falseか0を指定すると、円形グラデーションになります。
<span class='linenumber'>566</span>    *                             デフォルトは1です。
<span class='linenumber'>567</span>    * @param array colorStop - グラデーションカラーの変化点を指定します。&lt;br />
<span class='linenumber'>568</span>    *                          offsetには0.0～1.0の値を、colorには色を指定します。&lt;br />
<span class='linenumber'>569</span>    *                          [offset0, color0, offset1, color1, ...]の形式で指定します。&lt;br />
<span class='linenumber'>570</span>    *                          デフォルトはundefinedです。
<span class='linenumber'>571</span>    * @return CanvasGradient - グラデーションオブジェクトを返します。
<span class='linenumber'>572</span>    */</span><span class="WHIT">
<span class='linenumber'>573</span> </span><span class="WHIT">  </span><span class="NAME">gradation</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">point</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">line</span><span class="WHIT"> </span><span class="COMM">/* = 1 */</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">colorStop</span><span class="WHIT"> </span><span class="COMM">/* = undefined */</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>574</span> </span><span class="WHIT">    </span><span class="NAME">this._cmdRec</span><span class="PUNC">(</span><span class="STRN">"gradation"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">point</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">line</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">colorStop</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>575</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">rv</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>576</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">line</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">line</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">"undefined"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>577</span> </span><span class="WHIT">      </span><span class="NAME">rv</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.ctx.createLinearGradient</span><span class="PUNC">(</span><span class="NAME">point</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">point</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">point</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">point</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>578</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>579</span> </span><span class="WHIT">      </span><span class="NAME">rv</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.ctx.createRadialGradient</span><span class="PUNC">(</span><span class="NAME">point</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">point</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">point</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">point</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">point</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">point</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>580</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>581</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">uu.isA</span><span class="PUNC">(</span><span class="NAME">colorStop</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>582</span> </span><span class="WHIT">      </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">colorStop.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>583</span> </span><span class="WHIT">        </span><span class="NAME">rv.addColorStop</span><span class="PUNC">(</span><span class="NAME">color</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">color</span><span class="PUNC">[</span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>584</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>585</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>586</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">rv</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>587</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>588</span> </span><span class="WHIT">  </span><span class="COMM">/** &lt;b>uu.module.context2dDebug.drawImage - 画像の描画&lt;/b>
<span class='linenumber'>589</span>    */</span><span class="WHIT">
<span class='linenumber'>590</span> </span><span class="WHIT">  </span><span class="NAME">drawImage</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">image</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">sx</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">sy</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">sw</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">sh</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">dx</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">dy</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">dw</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">dh</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>591</span> </span><span class="WHIT">    </span><span class="KEYW">switch</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">arguments.length</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>592</span> </span><span class="WHIT">    </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.ctx.drawImage</span><span class="PUNC">(</span><span class="NAME">image</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>593</span> </span><span class="WHIT">    </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.ctx.drawImage</span><span class="PUNC">(</span><span class="NAME">image</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">sx</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">sy</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>594</span> </span><span class="WHIT">    </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">5</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.ctx.drawImage</span><span class="PUNC">(</span><span class="NAME">image</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">sx</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">sy</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">sw</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">sh</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>595</span> </span><span class="WHIT">    </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">9</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.ctx.drawImage</span><span class="PUNC">(</span><span class="NAME">image</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">sx</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">sy</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">sw</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">sh</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">dx</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">dy</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">dw</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">dh</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>596</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>597</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>598</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>599</span> </span><span class="WHIT">  </span><span class="COMM">/** &lt;b>create gradation set&lt;/b>
<span class='linenumber'>600</span>    *
<span class='linenumber'>601</span>    * @param string name
<span class='linenumber'>602</span>    * @param array  params
<span class='linenumber'>603</span>    * 
<span class='linenumber'>604</span>    */</span><span class="WHIT">
<span class='linenumber'>605</span> </span><span class="WHIT">  </span><span class="NAME">PRESET_GRADATION_REFRECTION_IMAGE</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>606</span> </span><span class="WHIT">  </span><span class="NAME">createPresetGradation</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">params</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>607</span> </span><span class="WHIT">    </span><span class="KEYW">switch</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>608</span> </span><span class="WHIT">    </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">this.PRESET_GRADATION_REFRECTION_IMAGE</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="COMM">// params[0] = height</span><span class="WHIT">
<span class='linenumber'>609</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.gradation</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">params</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"rgba(0, 0, 0, 0.5)"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"rgba(0, 0, 0, 1.0)"</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>610</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>611</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>612</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>613</span> </span><span class="WHIT">  </span><span class="COMM">/* ok keep */</span><span class="WHIT">
<span class='linenumber'>614</span> </span><span class="WHIT">  </span><span class="NAME">drawReflectImage</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">img</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">reflectionGradation</span><span class="WHIT"> </span><span class="COMM">/* = undefined */</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>615</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">gra</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">reflectionGradation</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="STRN">"undefined"</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'>616</span> </span><span class="WHIT">            </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">reflectionGradation</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.createPresetGradation</span><span class="PUNC">(</span><span class="NAME">this.PRESET_GRADATION_REFRECTION_IMAGE</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>617</span> </span><span class="COMM">//    this.clear(0, 0, w, h * 2);</span><span class="WHIT">
<span class='linenumber'>618</span> </span><span class="WHIT">    </span><span class="NAME">this.push</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">translate</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">h</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">scale</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">drawImage</span><span class="PUNC">(</span><span class="NAME">img</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>619</span> </span><span class="WHIT">    </span><span class="NAME">this.mix</span><span class="PUNC">(</span><span class="STRN">"destination-out"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">fillRect</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">gra</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>620</span> </span><span class="WHIT">    </span><span class="NAME">this.pop</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>621</span> </span><span class="WHIT">    </span><span class="NAME">this.drawImage</span><span class="PUNC">(</span><span class="NAME">img</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>622</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>623</span> </span><span class="WHIT">  </span><span class="COMM">/* 早いけど、背景が黒じゃなきゃダメ */</span><span class="WHIT">
<span class='linenumber'>624</span> </span><span class="WHIT">  </span><span class="NAME">drawQuickReflectScaledImage</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">img</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">scale</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">reflectionHeight</span><span class="WHIT"> </span><span class="COMM">/* = 50 */</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">reflectionGradation</span><span class="WHIT"> </span><span class="COMM">/* = undefined */</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>625</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="COMM">// rh = reflectionHeight || 50,</span><span class="WHIT">
<span class='linenumber'>626</span> </span><span class="WHIT">        </span><span class="NAME">gra</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">reflectionGradation</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="STRN">"undefined"</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'>627</span> </span><span class="WHIT">            </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">reflectionGradation</span><span class="WHIT">
<span class='linenumber'>628</span> </span><span class="WHIT">            </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.createPresetGradation</span><span class="PUNC">(</span><span class="NAME">this.PRESET_GRADATION_REFRECTION_IMAGE</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>629</span> 
<span class='linenumber'>630</span> </span><span class="WHIT">    </span><span class="NAME">this.push</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>631</span> </span><span class="WHIT">    </span><span class="NAME">this.translate</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'>632</span> </span><span class="WHIT">    </span><span class="NAME">this.scale</span><span class="PUNC">(</span><span class="NAME">scale</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">scale</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>633</span> </span><span class="COMM">//    this.strokeRect(0, 0, w, h, "pink");</span><span class="WHIT">
<span class='linenumber'>634</span> </span><span class="WHIT">    </span><span class="NAME">this.drawImage</span><span class="PUNC">(</span><span class="NAME">img</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>635</span> </span><span class="WHIT">    </span><span class="NAME">this.pop</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>636</span> 
<span class='linenumber'>637</span> </span><span class="WHIT">    </span><span class="NAME">this.push</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>638</span> </span><span class="WHIT">    </span><span class="NAME">this.translate</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">h</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">scale</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">scale</span><span class="PUNC">(</span><span class="NAME">scale</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NAME">scale</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">drawImage</span><span class="PUNC">(</span><span class="NAME">img</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>639</span> </span><span class="WHIT">    </span><span class="NAME">this.mix</span><span class="PUNC">(</span><span class="STRN">"destination-out"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">fillRect</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">gra</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>640</span> </span><span class="WHIT">    </span><span class="NAME">this.pop</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>641</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>642</span> </span><span class="WHIT">  </span><span class="COMM">// operaはglobalAlphaの値がdrawImage()に反映されない</span><span class="WHIT">
<span class='linenumber'>643</span> </span><span class="WHIT">  </span><span class="NAME">drawReflectScaledImage</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">img</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">scale</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">reflectionHeight</span><span class="WHIT"> </span><span class="COMM">/* = 50 */</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>644</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">rh</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">reflectionHeight</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">50</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>645</span> </span><span class="WHIT">    </span><span class="NAME">this.push</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>646</span> </span><span class="WHIT">    </span><span class="NAME">this.translate</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'>647</span> </span><span class="WHIT">    </span><span class="NAME">this.scale</span><span class="PUNC">(</span><span class="NAME">scale</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">scale</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>648</span> </span><span class="COMM">//    this.strokeRect(0, 0, w, h, "pink");</span><span class="WHIT">
<span class='linenumber'>649</span> </span><span class="WHIT">    </span><span class="NAME">this.drawImage</span><span class="PUNC">(</span><span class="NAME">img</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>650</span> </span><span class="WHIT">    </span><span class="NAME">this.pop</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>651</span> 
<span class='linenumber'>652</span> </span><span class="WHIT">    </span><span class="NAME">this.push</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>653</span> </span><span class="WHIT">    </span><span class="NAME">this.translate</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">h</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">scale</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">scale</span><span class="PUNC">(</span><span class="NAME">scale</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NAME">scale</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>654</span> </span><span class="WHIT">    </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">a</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">rh</span><span class="WHIT"> </span><span class="REGX">/ 100; i &lt; rh /</span><span class="WHIT"> </span><span class="NAME">scale</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">a</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0.01</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>655</span> </span><span class="WHIT">      </span><span class="NAME">this.alpha</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">drawImage</span><span class="PUNC">(</span><span class="NAME">img</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">h</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">h</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>656</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>657</span> </span><span class="WHIT">    </span><span class="NAME">this.pop</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>658</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>659</span> </span><span class="WHIT">  </span><span class="COMM">/** 画像をキャンバスのサイズに拡大/縮小しコピーする
<span class='linenumber'>660</span>    *
<span class='linenumber'>661</span>    * wとhよりも画像が小さければ、拡大コピーします。
<span class='linenumber'>662</span>    * wまたはhが大きくければ縮小しコピーします。
<span class='linenumber'>663</span>    */</span><span class="WHIT">
<span class='linenumber'>664</span> </span><span class="WHIT">  </span><span class="NAME">drawFixedImage</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">img</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>665</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">sw</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">img.width</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">sh</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">img.height</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>666</span> </span><span class="WHIT">        </span><span class="NAME">cw</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.ctx.canvas.width</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>667</span> </span><span class="WHIT">        </span><span class="NAME">ch</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.ctx.canvas.height</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>668</span> </span><span class="WHIT">        </span><span class="NAME">dx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">sw</span><span class="WHIT"> </span><span class="PUNC">&lt;=</span><span class="WHIT"> </span><span class="NAME">cw</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">cw</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">sw</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="REGX">/ 2) : 0,
<span class='linenumber'>669</span>         dy = (sh &lt;= ch) ? Math.floor((ch - sh) /</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>670</span> </span><span class="WHIT">        </span><span class="NAME">dw</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">sw</span><span class="WHIT"> </span><span class="PUNC">&lt;=</span><span class="WHIT"> </span><span class="NAME">cw</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">sw</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">cw</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>671</span> </span><span class="WHIT">        </span><span class="NAME">dh</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">sh</span><span class="WHIT"> </span><span class="PUNC">&lt;=</span><span class="WHIT"> </span><span class="NAME">ch</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">sh</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">ch</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>672</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.drawImage</span><span class="PUNC">(</span><span class="NAME">img</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">sw</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">sh</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">dx</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">dy</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">dw</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">dh</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>673</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>674</span> </span><span class="WHIT">  </span><span class="COMM">//////////////////////////////////////////////////////////</span><span class="WHIT">
<span class='linenumber'>675</span> </span><span class="WHIT">  </span><span class="NAME">_mix</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">method</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>676</span> </span><span class="WHIT">    </span><span class="NAME">this.ctx.globalCompositeOperation</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">method</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>677</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>678</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>679</span> </span><span class="WHIT">  </span><span class="NAME">_alpha</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">alpha</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>680</span> </span><span class="WHIT">    </span><span class="NAME">this.ctx.globalAlpha</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">alpha</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>681</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>682</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>683</span> </span><span class="WHIT">  </span><span class="NAME">_clear</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>684</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">arguments.length</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>685</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">w</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">x</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">w</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NAME">w</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>686</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">h</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">y</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">h</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>687</span> </span><span class="WHIT">      </span><span class="NAME">this.ctx.clearRect</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'>688</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>689</span> </span><span class="WHIT">      </span><span class="NAME">this.ctx.clearRect</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.ctx.canvas.width</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.ctx.canvas.height</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>690</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>691</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>692</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>693</span> </span><span class="WHIT">  </span><span class="NAME">_begin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'>694</span> </span><span class="WHIT">    </span><span class="NAME">this.ctx.beginPath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>695</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">arguments.length</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>696</span> </span><span class="WHIT">      </span><span class="NAME">this._posRec</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">x</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">y</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>697</span> </span><span class="WHIT">      </span><span class="NAME">this.ctx.moveTo</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>698</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>699</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>700</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>701</span> </span><span class="WHIT">  </span><span class="NAME">_close</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>702</span> </span><span class="WHIT">    </span><span class="NAME">this.ctx.closePath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>703</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">arguments.length</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>704</span> </span><span class="WHIT">      </span><span class="NAME">this._posRec</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">x</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">y</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>705</span> </span><span class="WHIT">      </span><span class="NAME">this.ctx.moveTo</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>706</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>707</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>708</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>709</span> </span><span class="WHIT">  </span><span class="NAME">_move</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>710</span> </span><span class="WHIT">    </span><span class="NAME">this._posRec</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">x</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">y</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>711</span> </span><span class="WHIT">    </span><span class="NAME">this.ctx.moveTo</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>712</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>713</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>714</span> </span><span class="WHIT">  </span><span class="NAME">_line</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">point</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">style</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>715</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">sz</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">point.length</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>716</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">style</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">this._lineStyle</span><span class="PUNC">(</span><span class="NAME">style</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>717</span> </span><span class="WHIT">    </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">sz</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>718</span> </span><span class="WHIT">      </span><span class="NAME">this._posRec</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">point</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">point</span><span class="PUNC">[</span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>719</span> </span><span class="WHIT">      </span><span class="NAME">this.ctx.lineTo</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>720</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>721</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>722</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>723</span> </span><span class="WHIT">  </span><span class="NAME">_fill</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">style</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>724</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">style</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">this._fillStyle</span><span class="PUNC">(</span><span class="NAME">style</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>725</span> </span><span class="WHIT">    </span><span class="NAME">this.ctx.fill</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>726</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>727</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>728</span> </span><span class="WHIT">  </span><span class="NAME">_rect</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">style</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>729</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">style</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">this._lineStyle</span><span class="PUNC">(</span><span class="NAME">style</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>730</span> </span><span class="WHIT">    </span><span class="NAME">this._posRec</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">x</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">y</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>731</span> </span><span class="WHIT">    </span><span class="NAME">this.ctx.rect</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>732</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>733</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>734</span> </span><span class="WHIT">  </span><span class="NAME">_arc</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">param</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">style</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>735</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">style</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">this._lineStyle</span><span class="PUNC">(</span><span class="NAME">style</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>736</span> </span><span class="WHIT">    </span><span class="NAME">this._posRec</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">x</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">y</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>737</span> </span><span class="WHIT">    </span><span class="NAME">param</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">uu.mix.param</span><span class="PUNC">(</span><span class="NAME">param</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">100</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">a0</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">a1</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">359</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">clock</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>738</span> </span><span class="WHIT">    </span><span class="NAME">this.ctx.arc</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">param.r</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">param.a0</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">Math.RADIAN</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">param.a1</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">Math.RADIAN</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">clock</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>739</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>740</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>741</span> </span><span class="WHIT">  </span><span class="NAME">_arcTo</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">point</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">style</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>742</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">style</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">this._lineStyle</span><span class="PUNC">(</span><span class="NAME">style</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>743</span> </span><span class="WHIT">    </span><span class="NAME">this.ctx.arc</span><span class="PUNC">(</span><span class="NAME">point</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">point</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">point</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">point</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>744</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>745</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>746</span> </span><span class="WHIT">  </span><span class="NAME">_curve</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">point</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">bezier</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">style</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>747</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">style</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">this._lineStyle</span><span class="PUNC">(</span><span class="NAME">style</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>748</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">bezier</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>749</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.ctx.bezierCurveTo</span><span class="PUNC">(</span><span class="NAME">point</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">point</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">point</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">point</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">point</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">point</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>750</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>751</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.ctx.quadraticCurveTo</span><span class="PUNC">(</span><span class="NAME">point</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">point</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">point</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">point</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>752</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>753</span> </span><span class="WHIT">  </span><span class="NAME">_stroke</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">style</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>754</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">style</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">this._strokeStyle</span><span class="PUNC">(</span><span class="NAME">style</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>755</span> </span><span class="WHIT">    </span><span class="NAME">this.ctx.stroke</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>756</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>757</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>758</span> </span><span class="WHIT">  </span><span class="NAME">_lineStyle</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">style</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>759</span> </span><span class="WHIT">    </span><span class="NAME">uu.mix</span><span class="PUNC">(</span><span class="NAME">this.ctx</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">style</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>760</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>761</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>762</span> </span><span class="WHIT">  </span><span class="NAME">_fillStyle</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">style</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>763</span> </span><span class="WHIT">    </span><span class="NAME">this.ctx.fillStyle</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">style</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>764</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>765</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>766</span> </span><span class="WHIT">  </span><span class="NAME">_strokeStyle</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">style</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>767</span> </span><span class="WHIT">    </span><span class="NAME">this.ctx.strokeStyle</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">style</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>768</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>769</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>770</span> </span><span class="WHIT">  </span><span class="NAME">_fillRect</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">abs</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">style</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>771</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">style</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">this._fillStyle</span><span class="PUNC">(</span><span class="NAME">style</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>772</span> </span><span class="WHIT">    </span><span class="NAME">this._posRec</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._posX</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">abs</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._posY</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">abs</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>773</span> </span><span class="WHIT">    </span><span class="NAME">this.ctx.fillRect</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>774</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>775</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>776</span> </span><span class="WHIT">  </span><span class="NAME">_storokeRect</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">abs</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">style</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>777</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">style</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">this._storokeStyle</span><span class="PUNC">(</span><span class="NAME">style</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>778</span> </span><span class="WHIT">    </span><span class="NAME">this._posRec</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._posX</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">abs</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._posY</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">abs</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>779</span> </span><span class="WHIT">    </span><span class="NAME">this.ctx.strokeRect</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>780</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>781</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>782</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>783</span> 
<span class='linenumber'>784</span> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// end (function())()</span><span class="WHIT">
<span class='linenumber'>785</span> </span></pre></body></html>